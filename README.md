# FFmpegShell
FFmpeg 智能命令执行器
这是一个 PowerShell 脚本，旨在自动化并增强 FFmpeg 的批量视频处理体验。它可以从一个指定的文本文件中读取一系列 FFmpeg 命令，并智能地、有序地执行它们，同时提供丰富的进度信息和错误处理机制。

✨ 主要功能
✅ 自动环境检测: 脚本启动时会自动检查系统中是否正确安装 ffmpeg 和 ffprobe，并确保它们在环境变量中可用。

📂 灵活的路径输入: 您可以输入 ffmpeg_commands.txt 文件的完整路径，也可以只输入该文件所在的文件夹路径，脚本会自动查找。

📊 清晰的任务总览: 在执行前，脚本会分析所有待处理的命令，计算出任务总数和所有视频的总时长，让您对工作量一目了然。

🔄 断点续传: 每当一个命令成功执行后，脚本会自动在该命令前添加 [DONE] 标记。当中断后重新运行时，所有已标记 [DONE] 的任务都会被自动跳过。

💥 智能文件冲突处理: 如果脚本发现命令的输出文件已经存在，它不会报错或停止，而是会自动将旧文件重命名（例如 video.mp4 -> video_old_1.mp4），然后继续执行任务。

📈 双层实时进度显示:

微进度: 在处理单个视频文件时，实时、逐行显示当前文件的完成百分比和处理速度。

整体进度: 每完成一个任务，都会刷新显示所有任务的总体进度条、已处理时长/总时长、已耗时以及动态预估的剩余时间。

🛡️ 稳定可靠: 脚本包含了稳健的错误处理机制，并采用优化的事件处理模型来确保实时进度显示的流畅与准确。

🚀 环境要求
操作系统: Windows 10 或更高版本

运行环境: PowerShell 5.1 或更高版本

核心依赖: FFmpeg (需要预先安装，并将其 bin 目录添加到系统的 PATH 环境变量中)

💡 如何使用
准备命令文件:
在您方便的位置创建一个名为 ffmpeg_commands.txt 的文本文件。将您需要执行的所有 FFmpeg 命令逐行写入此文件。

文件格式示例 (ffmpeg_commands.txt):

ffmpeg -i "C:\videos\input1.mp4" -c:v libx265 -crf 23 "D:\output\output1.mkv"
ffmpeg -i "C:\videos\input2.mov" -c:v libx265 -crf 23 "D:\output\output2.mkv"
ffmpeg -i "C:\videos\input3.avi" -c:a copy "D:\output\output3.mp4"

运行脚本:

右键点击 ffmpeg_runner_v3.2.ps1 脚本文件，选择“使用 PowerShell 运行”。

或者打开一个 PowerShell 窗口，输入脚本的完整路径并按回车。

输入路径:
根据提示，输入您创建的 ffmpeg_commands.txt 文件的完整路径，或者它所在的文件夹路径，然后按回车。

开始任务:
脚本会进行初始化并显示任务总览。确认无误后，按回车键，脚本将开始自动执行所有任务。

📄 许可证
本项目采用 MIT License 许可证。
